<!DOCTYPE html>
<html>
<head>
  <title>Admin – Assign Task</title>

  <!-- Firebase libraries -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>Assign Task to Employee</h2>

  <label>Email of Employee:</label><br />
  <input type="email" id="empEmail" placeholder="employee@example.com" /><br /><br />

  <label>Date:</label><br />
  <input type="date" id="taskDate" /><br /><br />

  <label>Task Description:</label><br />
  <textarea id="taskDesc" rows="4" cols="50" placeholder="Enter task..."></textarea><br /><br />

  <button onclick="assignTask()">Assign Task</button>

  <script src="firebase-config.js"></script>
  <script>
    // ✅ Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Set today as default date
    document.getElementById("taskDate").value = new Date().toISOString().split("T")[0];

    function assignTask() {
      const email = document.getElementById("empEmail").value.trim();
      const task = document.getElementById("taskDesc").value.trim();
      const date = document.getElementById("taskDate").value;

      if (!email || !task || !date) {
        alert("Please fill all fields.");
        return;
      }

      const uid = prompt("Paste UID of the employee for " + email);
      if (!uid) {
        alert("Task not assigned. UID required.");
        return;
      }

      // Save to Firestore
      db.collection("tasks").doc(uid).collection(date).doc("task").set({ task: task })
        .then(() => {
          alert("✅ Task assigned!");
          document.getElementById("taskDesc").value = "";
        })
        .catch(error => {
          console.error("❌ Error assigning task:", error);
          alert("Failed to assign task.");
        });
    }
  </script>
</body>
</html>
